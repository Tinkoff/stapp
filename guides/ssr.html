
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>SSR Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="interop.html" />
    
    
    <link rel="prev" href="react.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../#stapp">
            
                    
                    Stapp
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../">
            
                <a href="../#installation">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../">
            
                <a href="../#introduction">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="../">
            
                <a href="../#stapp-core-concepts">
            
                    
                    Stapp core concepts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="../">
            
                <a href="../#quick-start">
            
                    
                    Quick start
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.5" data-path="../">
            
                <a href="../#modules">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.6" data-path="../">
            
                <a href="../#peer-dependencies">
            
                    
                    Peer dependencies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.7" data-path="../">
            
                <a href="../#license">
            
                    
                    License
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Core
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../core/createApp.html">
            
                <a href="../core/createApp.html">
            
                    
                    createApp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../core/createEvent.html">
            
                <a href="../core/createEvent.html">
            
                    
                    createEvent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../core/createEffect.html">
            
                <a href="../core/createEffect.html">
            
                    
                    createEffect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../core/createReducer.html">
            
                <a href="../core/createReducer.html">
            
                    
                    createReducer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../core/modules.html">
            
                <a href="../core/modules.html">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../core/epics.html">
            
                <a href="../core/epics.html">
            
                    
                    Epics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Guides
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="react.html">
            
                <a href="react.html">
            
                    
                    React
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.2" data-path="ssr.html">
            
                <a href="ssr.html">
            
                    
                    SSR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="interop.html">
            
                <a href="interop.html">
            
                    
                    RxJS and other reactive libs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Modules
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../modules/persist.html">
            
                <a href="../modules/persist.html">
            
                    
                    persist
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../modules/loaders.html">
            
                <a href="../modules/loaders.html">
            
                    
                    loaders
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../modules/formbase.html">
            
                <a href="../modules/formbase.html">
            
                    
                    formbase
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../modules/validate.html">
            
                <a href="../modules/validate.html">
            
                    
                    validate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../modules/select.html">
            
                <a href="../modules/select.html">
            
                    
                    select
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >SSR</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="server-side-render">Server-side render</h1>
<p>There is not that much what can be asked from a state-management library to support server-side render, but we tried to do our best.</p>
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<ul>
<li><a href="#usage">Usage</a><ul>
<li><a href="#timeouts">Timeouts</a></li>
</ul>
</li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<p>The main thing about server-side is delaying render until everything needed is loaded. Modules can tell the application what events they need to receive before the app can be rendered. The application exposes a special field, <code>ready</code>, which is a Promise, that will resolve after all of these events will be received by the store.</p>
<p>Later this Promise can be used anywhere, e.g., to delay the render on the server-side, or to indicate, that the app is ready to be used on the client-side.</p>
<h2 id="usage">Usage</h2>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { createEvent, createEffect, createReducer, createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;stapp&apos;</span>
<span class="hljs-keyword">const</span> myEffect = createEffect(<span class="hljs-string">&apos;My effect&apos;</span>, () =&gt; <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">&apos;my data&apos;</span>))
<span class="hljs-keyword">const</span> triggerEffect = createEvent(<span class="hljs-string">&apos;start effect&apos;</span>) 
<span class="hljs-keyword">const</span> <span class="hljs-built_in">module</span> = {
  state: {
    result: createReducer(<span class="hljs-literal">null</span>)
      .on(myEffect.success, (_, payload) =&gt; payload)
      .on(myEffect.fail, (_, error) =&gt; error),
    isLoading: createReducer(<span class="hljs-literal">false</span>)
      .on(myEffect.start, () =&gt; <span class="hljs-literal">true</span>)
      .on(myEffect.complete, () =&gt; <span class="hljs-literal">false</span>)
  },
  epic: triggerEffect.epic(ev$ =&gt; ev$.pipe(
    switchMap(myEffect)
  )),
  api: {
    triggerEffect
  },
  waitFor: [myEffect.complete]
}

<span class="hljs-keyword">const</span> app = createApp({
  name: <span class="hljs-string">&apos;My App&apos;</span>,
  modules: [<span class="hljs-built_in">module</span>]
})

<span class="hljs-comment">// Currently the `ready` promise is not resolved, because</span>
<span class="hljs-comment">// the app didn&apos;t receive `myEffect.complete` event.</span>
app.ready.then(state =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;State: &apos;</span>, <span class="hljs-built_in">JSON</span>.stringify(state))
})

app.api.triggerEffect()
<span class="hljs-comment">// Some time later:</span>
<span class="hljs-comment">// State: { result: &apos;my data&apos;, isLoading: false }</span>
</code></pre>
<p>See the working example on codesandbox.io:</p>
<p><a href="https://codesandbox.io/s/mzw2ozw8rx?module=%2Fsrc%2Findex.js" target="_blank"><img src="https://codesandbox.io/static/img/play-codesandbox.svg" alt="Edit mzw2ozw8rx"></a></p>
<h3 id="timeouts">Timeouts</h3>
<p>Module can provide not only an event creator or an event type, but also an object, defining the event and the timeout. Event will be added to the waiting queue as usual, and it will be removed from it on timeout.</p>
<pre><code class="lang-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> WaitFor = <span class="hljs-built_in">Array</span>&lt;
  | AnyEventCreator
  | <span class="hljs-built_in">string</span>
  | {
      event: AnyEventCreator | <span class="hljs-built_in">string</span>
      timeout: <span class="hljs-built_in">number</span>
    }
&gt;
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="react.html" class="navigation navigation-prev " aria-label="Previous page: React">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="interop.html" class="navigation navigation-next " aria-label="Next page: RxJS and other reactive libs">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"SSR","level":"1.3.2","depth":2,"next":{"title":"RxJS and other reactive libs","level":"1.3.3","depth":2,"path":"guides/interop.md","ref":"guides/interop.md","articles":[]},"previous":{"title":"React","level":"1.3.1","depth":2,"path":"guides/react.md","ref":"guides/react.md","articles":[]},"dir":"ltr"},"config":{"plugins":["edit-link"],"root":"./docs","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"edit-link":{"label":"Edit This Page","base":"https://github.com/TinkoffCreditSystems/stapp/blob/master/docs"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"guides/ssr.md","mtime":"2018-07-20T15:26:26.581Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-08-06T11:17:23.251Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

