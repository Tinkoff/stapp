
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>createApp Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="createEvent.html" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../#stapp">
            
                    
                    Stapp
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../">
            
                <a href="../#installation">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../">
            
                <a href="../#introduction">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="../">
            
                <a href="../#stapp-core-concepts">
            
                    
                    Stapp core concepts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="../">
            
                <a href="../#quick-start">
            
                    
                    Quick start
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.5" data-path="../">
            
                <a href="../#modules">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.6" data-path="../">
            
                <a href="../#peer-dependencies">
            
                    
                    Peer dependencies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.7" data-path="../">
            
                <a href="../#license">
            
                    
                    License
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Core
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.1" data-path="createApp.html">
            
                <a href="createApp.html">
            
                    
                    createApp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="createEvent.html">
            
                <a href="createEvent.html">
            
                    
                    createEvent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="createEffect.html">
            
                <a href="createEffect.html">
            
                    
                    createEffect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="createReducer.html">
            
                <a href="createReducer.html">
            
                    
                    createReducer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="modules.html">
            
                <a href="modules.html">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="epics.html">
            
                <a href="epics.html">
            
                    
                    Epics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Guides
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../guides/react.html">
            
                <a href="../guides/react.html">
            
                    
                    React
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../guides/ssr.html">
            
                <a href="../guides/ssr.html">
            
                    
                    SSR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../guides/interop.html">
            
                <a href="../guides/interop.html">
            
                    
                    RxJS and other reactive libs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Modules
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../modules/persist.html">
            
                <a href="../modules/persist.html">
            
                    
                    persist
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../modules/loaders.html">
            
                <a href="../modules/loaders.html">
            
                    
                    loaders
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../modules/formbase.html">
            
                <a href="../modules/formbase.html">
            
                    
                    formbase
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../modules/validate.html">
            
                <a href="../modules/validate.html">
            
                    
                    validate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../modules/select.html">
            
                <a href="../modules/select.html">
            
                    
                    select
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >createApp</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="createapp"><code>createApp()</code></h1>
<p>Creates a Stapp application.</p>
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<ul>
<li><a href="#definitions">Definitions</a></li>
<li><a href="#usage">Usage</a><ul>
<li><a href="#config">Config</a></li>
</ul>
</li>
<li><a href="#examples">Examples</a><ul>
<li><a href="#todos">Todos</a></li>
<li><a href="#todo-with-undo">Todo with undo</a></li>
</ul>
</li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<h2 id="definitions">Definitions</h2>
<pre><code class="lang-typescript"><span class="hljs-keyword">type</span> createApp = (config: {
  name?: <span class="hljs-built_in">string</span>
  modules: <span class="hljs-built_in">Array</span>&lt;Module | ModuleFactory&gt;
  dependencies?: <span class="hljs-built_in">any</span>
  rehydrate?: <span class="hljs-built_in">any</span>
  middlewares?: Middleware[]
}) =&gt; Stapp

<span class="hljs-keyword">type</span> Stapp&lt;State, API&gt; = {
  name: <span class="hljs-built_in">string</span>
  subscribe: (state: State) =&gt; <span class="hljs-built_in">void</span>
  api: API
  ready: Promise&lt;Partial&lt;State&gt;&gt;

  <span class="hljs-comment">// Imperative and not recommended to use API</span>
  <span class="hljs-comment">// Still useful for testing</span>
  dispatch: (event: <span class="hljs-built_in">any</span>) =&gt; <span class="hljs-built_in">any</span>
  getState: () =&gt; State
}
</code></pre>
<h2 id="usage">Usage</h2>
<p>Create a Stapp application by combining one or more modules with <code>createApp</code>:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;stapp&apos;</span>
<span class="hljs-keyword">import</span> { formBase } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;stapp-formbase&apos;</span>
<span class="hljs-keyword">import</span> { logger, counter, whatever } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../modules&apos;</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> app = createApp({
  name: <span class="hljs-string">&apos;My super app&apos;</span>,
  modules: [
    formBase,
    logger,
    counter,
    whatever
  ]
})
</code></pre>
<h3 id="config">Config</h3>
<ul>
<li><strong><code>name</code></strong>: Name is not required but recommended if you have more than one app (and you should have more than one app, in other cases, you might not need this library) and use redux-devtools. </li>
<li><strong><code>modules</code></strong>: See more about modules in the <a href="../usage/modules.html">corresponding section</a>.</li>
<li><strong><code>dependencies</code></strong>: Any function provided as a module will be called with the value of this field.</li>
<li><strong><code>middlewares</code></strong>: An array of any custom redux middlewares.</li>
<li><strong><code>rehydrate</code></strong>: Value provided here, will be used as an initial state in <code>redux.createStore</code> method.</li>
</ul>
<h2 id="examples">Examples</h2>
<h3 id="todos">Todos</h3>
<pre><code class="lang-javascript"><span class="hljs-comment">// todoModule.js</span>
<span class="hljs-keyword">import</span> { createReducer } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;stapp&apos;</span>

<span class="hljs-keyword">let</span> id = <span class="hljs-number">0</span>
<span class="hljs-keyword">const</span> uniqueId = () =&gt; id++
<span class="hljs-keyword">const</span> todosReducer = createReducer([])

<span class="hljs-keyword">const</span> events = todosReducer.createEvents({
  addTodo: (todos, todo) =&gt; todos.concat({id: uniqueId(), completed: <span class="hljs-literal">false</span>, text: todo }),
  deleteTodo: (todos, id) =&gt; todos.filter(todo =&gt; todo.id !== id),
  editTodo: (todos, payload) =&gt; todos.map(todo =&gt; todo.id === payload.id ? {...todo, text: payload.text } : todo),
  toggleComplete: (todos, id) =&gt; todos.map(todo =&gt; todo.id === id ? {...todo, completed: !todo.completed } : todo),
  removeCompleted: (todos) =&gt; todos.filter(todo =&gt; !todo.completed)
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> todoModule = {
  name: <span class="hljs-string">&apos;todos&apos;</span>,
  state: {
    todos: todosReducer
  },
  api: events
}

<span class="hljs-comment">// todoApp.js</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;stapp&apos;</span>
<span class="hljs-keyword">import</span> { todoModule } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./todoModule.js&apos;</span>

<span class="hljs-keyword">const</span> todoApp = createApp({
  name: <span class="hljs-string">&apos;Todo&apos;</span>,
  modules: [todoModule]
})

todoApp
    .subscribe(state =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`State: <span class="hljs-subst">${JSON.stringify(state)}</span>`</span>))
<span class="hljs-comment">// State: { todos: [] }</span>

todoApp.api.addTodo(<span class="hljs-string">&apos;Add first todo&apos;</span>)
<span class="hljs-comment">// State: { todos: [</span>
<span class="hljs-comment">//    { id: 0, completed: false, text: &apos;Add first todo&apos; }</span>
<span class="hljs-comment">// ] }</span>

todoApp.api.editTodo({ id: <span class="hljs-number">0</span>, text: <span class="hljs-string">&apos;Wait, didnt I already did this?&apos;</span>})
<span class="hljs-comment">// State: { todos: [</span>
<span class="hljs-comment">//    { id: 0, completed: false, text: &apos;Wait, didnt I already did this?&apos; }</span>
<span class="hljs-comment">// ] }</span>

todoApp.api.toggleComplete(<span class="hljs-number">0</span>)
<span class="hljs-comment">// State: { todos: [</span>
<span class="hljs-comment">//    { id: 0, completed: true, text: &apos;Wait, didnt I already did this?&apos; }</span>
<span class="hljs-comment">// ] }</span>

todoApp.api.removeCompleted()
<span class="hljs-comment">// State: { todos: [] }</span>
</code></pre>
<h3 id="todo-with-undo">Todo with undo</h3>
<p>Well, you easily can use excellent <a href="https://github.com/omnidan/redux-undo" target="_blank"><code>redux-undo</code></a> higher order reducer, but where is the fun? This example shows you the real power of epics.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// undoModule.js</span>
<span class="hljs-keyword">import</span> { tap, map, mapTo, filter } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;light-observable/operators&apos;</span>
<span class="hljs-keyword">import</span> { createEvent, combineEpics, dangerouslyReplaceState, selectArray } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;stapp&apos;</span>

<span class="hljs-keyword">const</span> undo = createEvent(<span class="hljs-string">&apos;Undo&apos;</span>)
<span class="hljs-keyword">const</span> redo = createEvent(<span class="hljs-string">&apos;Redo&apos;</span>)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> undoModule = () =&gt; {
  <span class="hljs-keyword">let</span> prev = []
  <span class="hljs-keyword">let</span> next = []

  <span class="hljs-comment">// Here we save state changes on every event excepts undo, redo and</span>
  <span class="hljs-comment">// special Stapp event dangerouslyReplaceState because they</span>
  <span class="hljs-comment">// will be handled separatly</span>
  <span class="hljs-keyword">const</span> saveStoreEpic = (event$, state$, { getState }) =&gt; event$.pipe(
    filter(({ type }) =&gt; (
      type !== undo.getType() &amp;&amp;
      type !== redo.getType() &amp;&amp;
      type !== dangerouslyReplaceState.getType()
    )),
    tap(() =&gt; {
      prev.push(getState())
      next = []
    }),
    mapTo(<span class="hljs-literal">null</span>)
  )

  <span class="hljs-comment">// Undo state changes</span>
  <span class="hljs-keyword">const</span> undoEpic = undo.epic((undo$, state$, { getState }) =&gt; undo$.pipe(
    filter(() =&gt; prev.length &gt; <span class="hljs-number">0</span>),
    tap(() =&gt; next.push(getState())),
    map(() =&gt; dangerouslyReplaceState(prev.pop()))
  ))

  <span class="hljs-comment">// Redo state changes</span>
  <span class="hljs-keyword">const</span> redoEpic = redo.epic((redo$, state$) =&gt; redo$.pipe(
    filter(() =&gt; next.length &gt; <span class="hljs-number">0</span>),
    tap(() =&gt; prev.push(getState())),
    map(() =&gt; dangerouslyReplaceState(next.pop()))
  ))

  <span class="hljs-comment">// undoModule is made as a function to store prev and next</span>
  <span class="hljs-comment">// arrays in the closure so that each application will have it&apos;s</span>
  <span class="hljs-comment">// own history.</span>
  <span class="hljs-keyword">return</span> {
    name: <span class="hljs-string">&apos;undo&apos;</span>,
    api: {
      undo,
      redo
    },
    epic: combineEpics([
      saveStoreEpic,
      undoEpic,
      redoEpic
    ])
  }
}

<span class="hljs-comment">// todoApp.js</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;stapp&apos;</span>
<span class="hljs-keyword">import</span> { todoModule } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./todoModule.js&apos;</span>
<span class="hljs-keyword">import</span> { undo } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./undoModule.js&apos;</span>

<span class="hljs-keyword">const</span> todoApp = createApp({
  name: <span class="hljs-string">&apos;Todo&apos;</span>,
  modules: [
    todoModule,
    undoModule()
  ]
})

todoApp.state$
  .subscribe(state =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`State: <span class="hljs-subst">${JSON.stringify(state)}</span>`</span>))
<span class="hljs-comment">// State: { todos: [] }</span>

todoApp.api.addTodo(<span class="hljs-string">&apos;Add first todo&apos;</span>)
<span class="hljs-comment">// State: { todos: [</span>
<span class="hljs-comment">//    { id: 0, completed: false, text: &apos;Add first todo&apos; }</span>
<span class="hljs-comment">// ] }</span>

todoApp.api.undo()
<span class="hljs-comment">// State: { todos: [] }</span>

todoApp.api.redo()
<span class="hljs-comment">// State: { todos: [</span>
<span class="hljs-comment">//    { id: 0, completed: false, text: &apos;Add first todo&apos; }</span>
<span class="hljs-comment">// ] }</span>
</code></pre>
<p>You can explore other examples in the examples section on GitHub.</p>
<!--
## Type definitions

* [`createApp`](/types.html#createApp)
* [`Stapp`](/types.html#stapp)
* [`Module`](/types.html#module)
* [`ModuleFactory`](/types.html#modulefactory)
-->

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="createEvent.html" class="navigation navigation-next navigation-unique" aria-label="Next page: createEvent">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"createApp","level":"1.2.1","depth":2,"next":{"title":"createEvent","level":"1.2.2","depth":2,"path":"core/createEvent.md","ref":"core/createEvent.md","articles":[]},"previous":{"title":"Core","level":"1.2","depth":1,"ref":"","articles":[{"title":"createApp","level":"1.2.1","depth":2,"path":"core/createApp.md","ref":"core/createApp.md","articles":[]},{"title":"createEvent","level":"1.2.2","depth":2,"path":"core/createEvent.md","ref":"core/createEvent.md","articles":[]},{"title":"createEffect","level":"1.2.3","depth":2,"path":"core/createEffect.md","ref":"core/createEffect.md","articles":[]},{"title":"createReducer","level":"1.2.4","depth":2,"path":"core/createReducer.md","ref":"core/createReducer.md","articles":[]},{"title":"Modules","level":"1.2.5","depth":2,"path":"core/modules.md","ref":"core/modules.md","articles":[]},{"title":"Epics","level":"1.2.6","depth":2,"path":"core/epics.md","ref":"core/epics.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["edit-link"],"root":"./docs","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"edit-link":{"label":"Edit This Page","base":"https://github.com/TinkoffCreditSystems/stapp/blob/master/docs"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"core/createApp.md","mtime":"2018-08-20T14:31:54.634Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-08-20T14:31:59.070Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

